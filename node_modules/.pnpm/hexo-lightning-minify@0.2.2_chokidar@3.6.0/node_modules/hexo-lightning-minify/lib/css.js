"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.minifyCss = minifyCss;
const utils_1 = require("./utils");
const browserslist_1 = __importDefault(require("browserslist"));
const lightningcss_1 = require("lightningcss");
function minifyCss(str, data) {
    const { options, exclude } = this.config.minify.css;
    const targets = (0, lightningcss_1.browserslistToTargets)((0, browserslist_1.default)(options.targets || '>= 0.5%'));
    if ((0, utils_1.isExclude)(data.path, exclude))
        return str;
    return (0, lightningcss_1.transform)({
        filename: data.path,
        code: Uint8Array.from(Buffer.from(str)),
        minify: true,
        targets
    }).code.toString();
}
